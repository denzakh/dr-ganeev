# Сайт dr-ganeev.ru

Сайт доктора Ганеева. Сделан для изучения и обкатки современных технологий фронтенда, в том числе сборки и деплоя.

![](https://raw.githubusercontent.com/denzakh/dr-ganeev/master/docs/promo.jpg)

## Структура

**.git** – служебная папка гита, хранит локальную копию репозитория.

**.github** – служебная папка гитхаба. Файл `.github/workflows/deploy.yml` содержит инструкции по деплою на сервер.

**docs** – файлы документации проекта. 

**src** – папка с исходниками. Здесь ведется разработка, хранятся HTML, исходники стилей в less, JS и несжатые картинки.

**dist** – папка с результатом. Сюда настроен корень веб-сервера на локалке. Содержимое этой папки деплоится на рабочий сервер.

**node_modules** – служебная папка с модулями ноды. Лежит вне гита. Создается на основе списка зависимостей в `package.json`.

**.gitignore** – список файлов и папок, которые не должны попасть в гит.

**gulpfile.js** – файл сценариев сборки

**package.json** – основной файл конфигурации, содержит список npm-зависимостей и скриптов запуска.

## Разработка

Основана на сценариях gulp (v4), описанных в `gulpfile.js`. Часть задач галпа экспортируются и могут быть запущены из консоли как через файл галпа  
`$ npm run gulp`, так и как сценарии npm `$ npm start` (описаны в package.json). Задачи:

**js** – сборка и минификация javascript cтранспиляцией в ES5.

**css** – сборка и минификация css из less, точка входа – файл `style.less`. 

**img** – сжатие картинок плагинами imagemin: mozjpeg, gifsicle, optipng, svgo.

**html** – копирует html c удалением пробелов.

**deploy** – требует наличия в системе `rsync` (Linux или [WSL](https://webdesign-master.ru/blog/tools/2018-12-12-linux-subsustem.html)). 

**watch** – задача по умолчанию для gulp и npm, после запуска отслеживает изменения js, less и html в папке src, при изменении файлов запускает соответствующие задачи (сборка js и css, копирование html). Экспортируется как `default`, запуск из консоли `$ npm start`.

**build** – собирает стили, js, html и картинки. Экспортируется. Запуск `$ npm run build`.

**deploy** – заливает файлы на рабочий сервер. Экспортируется. Автоматически запускается на github при `git push`. Запуск на локалке возможен при наличие линукса, но не желателен.

